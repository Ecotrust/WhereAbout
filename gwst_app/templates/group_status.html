{% extends "base.html" %}

{% block content %}

<script language="javascript">
function verify(link) {
    var agree=confirm("Are you sure you want to skip this group?  You won't be able to undo this action.");
    if (agree) {
        location.href=link;
    }
}
</script>

<br/>
<div style='width:600px;'>
{{ interview.group_status_text|safe }}
</div>
<br/>

{% if user.is_staff %}
<a href='/reset_interview/{{interview.id}}'>Restart Survey</a>
<br/>
<br/>
{% endif %}

<ul>
{% for object in object_list %}
  <li style='line-height:16px'>
  {% ifequal object.status "finalized" %}
    <img src="/site-media/images/accept.png" alt="Finalized"/>
  {% endifequal %}    
  {% ifequal object.status "skipped" %}
    <img src="/site-media/images/accept.png" alt="Skipped"/>
  {% endifequal %}    
  {% ifnotequal object.status "finalized" %}
    {% ifnotequal object.status "skipped" %}
        <img src="/site-media/images/delete.png" alt="Incomplete"/>
    {% endifnotequal %}
  {% endifnotequal %}
  
  <b>{{ object.int_group.name|capfirst }}</b>:   
  {{object.status|capfirst}}
  {% ifequal object.status "in-progress" %}    
    {% if object.int_group.user_draws_shapes %}
      - {{object.user_status_msg}}
    {% endif %}
  {% endifequal %}
  <br/>

  {% ifnotequal object.status "skipped" %}  
	  <ul>
	  {% ifequal object.status "finalized" %}
	     <li>Done. <a href="/group_qs/{{object.int_group.id}}/view/">Review answers</a></li>
	     <li>Done. <a href="/unfinalize_group/{{object.int_group.id}}/">Re-open this group</a></li>
	  {% else %}
	    {% ifequal object.status "in-progress" %}
	      <li>Done. <a href="/group_qs/{{object.int_group.id}}/answer/">Edit answers</a></li>
	    {% else %}
	      <li><a href="/group_qs/{{object.int_group.id}}/answer/">Answer questions</a></li>
	    {% endifequal %} 
	    {% ifequal object.status "in-progress" %}
	      {% if object.int_group.user_draws_shapes %}
	        {% ifnotequal object.num_incomplete_resources 0 %}
	        <li>Done. <a href="/review_resource_questions/{{object.int_group.id}}/">Edit {{interview.resource_name}}-specific answers</a></li>
	        {% else %}
	            {% ifnotequal object.num_complete_resources 0 %}
	        <li>Done. <a href="/review_resource_questions/{{object.int_group.id}}/">Edit {{interview.resource_name}}-specific answers</a></li>
	            {% endifnotequal %}
	        {% endifnotequal %}
	        <li>
	          {% ifequal num_shapes 0 %}
	            <a href="/draw_group_shapes/{{object.int_group.id}}/">Draw shapes</a>
		  {% else %}
		    <a href="/draw_group_shapes/{{object.int_group.id}}/">Continue drawing/editing shapes</a>
		{% endifequal %}
		</li>
	      {% endif %}
	      {% if object.int_group.user_draws_shapes %}
	        {% ifnotequal object.num_complete_resources 0 %}
	          {% ifequal object.num_incomplete_resources 0 %}
	            <li><a href="/finalize_group/{{object.int_group.id}}/">Finalize this group</a></li> 
	          {% endifequal %}
	        {% endifnotequal %}
	      {% else %}
	        <li><a href="/finalize_group/{{object.int_group.id}}/">Finalize this group</a></li>       
	      {% endif %}
	    {% endifequal %}
	  {% endifequal %}
	  
	  {% ifnotequal forloop.counter 1 %}
	  {% ifnotequal forloop.counter 2 %}
	  {% ifnotequal object.status "skipped" %}
	  {% ifnotequal object.status "finalized" %}
	    <li><a href='#' onclick="verify('/skip_group/{{object.int_group.id}}/')">Skip this group</a></li>
	  {% endifnotequal %}
	  {% endifnotequal %}
	  {% endifnotequal %}
	  {% endifnotequal %}
	  
	  </ul>
  {% endifnotequal %}
  <br/>
{% endfor %}

<li style='line-height:16px'>
<img src="/site-media/images/delete.png" alt="Incomplete"/>
<b> Interview status: in-progress</b>
{% if allow_finalize %}
<ul><li>
<a href="/finalize_interview/{{interview.id}}/">Finalize this interview</a></h4></li>
</li></ul>
{% endif %}
</li>

</ul>



{% endblock %}
